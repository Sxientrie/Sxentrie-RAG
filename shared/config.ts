import { GitHubFile, RepoInfo } from "../src/domains/repository-analysis/domain";
export const MAX_DISPLAY_FILE_SIZE = 500000;
export const MAX_GEMINI_FILE_SIZE = 20000;
export const MAX_GEMINI_FILE_COUNT = 15;
export const MAX_FILE_CACHE_SIZE = 50;
export const UI_DEBOUNCE_DELAY_MS = 100;
export const UI_COPY_SUCCESS_TIMEOUT_MS = 2000;
export const UI_ERROR_TOAST_TIMEOUT_MS = 5000;
export const AUTH_POPUP_MONITOR_INTERVAL_MS = 500;
export const SESSION_STORAGE_KEY = 'sxentrie-session';
export const SETTINGS_STORAGE_KEY = 'sxentrie-settings';
export const AUTH_CALLBACK_PATH = '/auth/callback';
export const GITHUB_LOGIN_POPUP_WIDTH = 600;
export const GITHUB_LOGIN_POPUP_HEIGHT = 700;
export const GITHUB_LOGIN_POPUP_NAME = 'github-login';
export const GITHUB_OAUTH_SCOPE = 'read:user user:email';
export const AUTH_SUCCESS_MESSAGE_TYPE = 'auth-success';
export const AUTH_ERROR_MESSAGE_TYPE = 'auth-error';
export const DEFAULT_DOWNLOAD_FILENAME = 'download';
export const TRUNCATED_DISPLAY_MESSAGE = "\n\n... (file truncated for display)";
export const TRUNCATED_GEMINI_MESSAGE = "\n... (file truncated)";
export const MARKDOWN_FILE_EXTENSION = '.md';
export const REPORT_FILE_MIMETYPE = 'text/markdown;charset=utf-8';
export const GENERIC_FILE_MIMETYPE = 'text/plain;charset=utf-8';
export const ICON_SIZE_XS = 12;
export const ICON_SIZE_SM = 14;
export const ICON_SIZE_MD = 16;
export const ICON_SIZE_LG = 20;
export const ICON_SIZE_XL = 48;
export const GEMINI_TEMPERATURE_REGULAR = 0.5;
export const GEMINI_TEMPERATURE_LOW = 0.2;
export const GEMINI_THINKING_BUDGET_UNLIMITED = -1;
export const HTTP_STATUS_OK = 200;
export const HTTP_STATUS_BAD_REQUEST = 400;
export const HTTP_STATUS_UNAUTHORIZED = 401;
export const HTTP_STATUS_FORBIDDEN = 403;
export const HTTP_STATUS_NOT_FOUND = 404;
export const HTTP_STATUS_INTERNAL_SERVER_ERROR = 500;
export const UI_FONT_SIZE_SM = '0.8rem';
export const UI_FONT_SIZE_MD = '0.85rem';
export const UI_GAP_SM = '0.5rem';
export const RightPanelViewer = 'viewer';
export const RightPanelSettings = 'settings';
export const MediaQuerySm = '(max-width: 600px)';
export const MediaQueryMd = '(max-width: 960px)';
export const DefaultRepoTitle = "Repository";
export const FileTreePlaceholder = "Load a repository to see the file tree.";
export const ErrorBoundaryFileTree = "File Tree Panel";
export const ErrorBoundaryAnalysis = "Analysis Panel";
export const ErrorBoundaryRightPanel = "Right Panel";
export const ErrorCorruptedSession = "Could not restore your previous session. The saved data was corrupted. Starting fresh.";
export const ErrorLocalStorageSave = 'Failed to save session to local storage.';
export const ErrorInvalidGitHubUrl = 'Invalid GitHub URL format.';
export const ErrorUnknown = 'An unknown error occurred.';
export const ErrorApiKeyNotSet = "API key is not set. Please provide a key in the settings or ensure the platform key is configured.";
export const ErrorNoFilesProvided = "No files provided for analysis.";
export const ErrorCouldNotFetchContent = "Could not fetch content from any files. The repository might be empty or contain only unsupported file types.";
export const ErrorUnknownAnalysis = 'An unknown error occurred during analysis.';
export const ErrorInvalidRequestBody = 'Invalid request body.';
export const ErrorCouldNotParseApiKey = 'Could not parse API key from settings. Please check your settings and save them again.';
export const ErrorRepositoryNotFound = 'Repository not found.';
export const ErrorGitHubApiRateLimitExceeded = 'GitHub API rate limit exceeded. Please wait and try again.';
export const ErrorGitHubApi = 'GitHub API Error: {0}';
export const ErrorCouldNotDetermineDefaultBranch = 'Could not determine the default branch for this repository.';
export const ErrorDefaultBranchNotFound = 'Default branch \'{0}\' not found or repository is empty.';
export const ErrorFailedToCopy = 'Failed to copy file content to clipboard.';
export const ErrorNetworkResponseNotOk = 'Network response was not ok';
export const ErrorFailedToDownload = 'Failed to download file. An unexpected error occurred.';
export const ErrorRepositoryNotLoaded = 'A repository must be loaded before running analysis.';
export const ErrorDocGenRepositoryNotLoaded = 'A repository must be loaded before generating documentation.';
export const ErrorFailedToCopyMarkdown = 'Failed to copy markdown to clipboard:';
// FIX: Added missing prompt constants.
export const PromptOverviewHeaderFile = 'You are an expert software architect. Provide a high-level technical overview of the following file.';
export const PromptOverviewHeaderRepo = 'You are an expert software architect. Provide a high-level technical overview of the following repository.';
export const PromptOverviewBodyFile = "Focus on its purpose, primary responsibilities, key components (functions, classes), and its role within the larger application architecture.";
export const PromptOverviewBodyRepo = "Focus on the project's purpose, technology stack, architecture, and key features. Do not analyze individual files in detail.";
export const PromptReviewFocusDefault = 'Your focus is on providing a comprehensive, high-quality code review. Act as a Senior Security & Performance Auditor. Identify potential bugs, security vulnerabilities, performance bottlenecks, and areas for improved maintainability, readability, and adherence to best practices. Be as thorough and insightful as possible. Prioritize critical issues over minor stylistic suggestions.';

export const LanguageGuidelines: Record<string, string> = {
    'typescript': 'Check for: Proper type safety (avoid `any`), correct usage of interfaces vs types, strict null checks, and efficient async/await usage.',
    'javascript': 'Check for: Modern ES6+ syntax usage, potential runtime errors, variable scoping issues (var vs let/const), and proper error handling.',
    'react': 'Check for: Correct `useEffect` dependency arrays, unnecessary re-renders (useMemo/useCallback usage), proper hook rules adherence, and accessibility (a11y) best practices.',
    'python': 'Check for: Pythonic idioms (list comprehensions, etc.), proper type hinting (PEP 484), efficient data structure usage, and correct exception handling.',
    'go': 'Check for: Proper error handling (if err != nil), goroutine leaks, correct channel usage, and efficient memory management.',
    'java': 'Check for: Proper exception handling, thread safety, efficient stream usage, and adherence to OOP principles.',
    'css': 'Check for: Maintainable selector structure, efficient use of CSS variables, responsive design best practices, and cross-browser compatibility.',
    'html': 'Check for: Semantic HTML usage, accessibility attributes (aria-*, alt), and proper document structure.',
};

export const JsonResponseMimeType = "application/json";
export const StreamTypeProgress = "progress";
export const StreamTypeResult = "result";
export const StreamTypeError = "error";
export const StreamMessageAnalysis = "Generating comprehensive analysis...";
// FIX: Added missing stream message constants.
export const StreamMessagePhase1 = 'Generating project overview...';
export const StreamMessagePhase2 = 'Performing technical review...';
export const StreamMessageFinalizing = "Finalizing analysis...";
export const StreamMessageFetchingFileTemplate = 'Fetching file: {0} ({1}/{2})';
export const HttpHeaderContentTypeJsonUtf8 = 'application/json; charset=utf-8';
export const GitHubClientIdPlaceholder = 'iv1.a2b3c4d5e6f7a8b9c0d1';
export const ErrorGitHubClientIdNotSet = "Configuration Error: The GitHub Client ID has not been set up. Authentication is disabled. Please see the console (F12) for details.";
export const DevErrorGitHubClientIdNotSet = "GitHub Client ID is not configured. Please replace the placeholder in `src/domains/accounts/infrastructure/auth-service.ts` or follow the `GUIDE.md` to set up a proper build process.";
export const GitHubAuthUrl = 'https://github.com/login/oauth/authorize';
export const ApiLogoutPath = '/api/auth/logout';
export const FileContentSeparator = '\n\n';
export const FileHeaderTemplate = '--- File: {0} ---\n';
export const AnalysisTargetFileTemplate = "the file '{0}'";
export const AnalysisTargetRepoTemplate = "the '{0}' repository";
export const SeverityCritical = 'Critical';
export const SeverityHigh = 'High';
export const SeverityMedium = 'Medium';
export const SeverityLow = 'Low';
export const ExplanationTypeText = 'text';
export const ExplanationTypeCode = 'code';
export const ErrorNoCodeProvided = 'No code provided.';
export const ErrorJwtSecretNotSet = 'JWT_SECRET environment variable is not set.';
export const GitHubAccessTokenUrl = 'https://github.com/login/oauth/access_token';
export const HttpMethodPost = 'POST';
export const HttpHeaderContentType = 'Content-Type';
export const HttpHeaderAccept = 'Accept';
export const GitHubUserApiUrl = 'https://api.github.com/user';
export const HttpHeaderAuthorization = 'Authorization';
export const AuthBearerPrefix = 'Bearer ';
export const JwtAlgorithmHS256 = 'HS256';
export const CookieAttributes = 'HttpOnly; Secure; Path=/; SameSite=Lax; Max-Age=';
export const ErrorAuthFailed = 'Authentication failed.';
export const CookieAttributesWithExpires = 'HttpOnly; Secure; Path=/; SameSite=Lax; Expires=';
export const ErrorNoFilesForDocumentation = 'No files provided for documentation.';
export const FileContentsPlaceholder = '{FILE_CONTENTS}';
export const ErrorConfig = 'Configuration error';
export const HttpHeaderCookie = 'Cookie';
export const ErrorNotAuthenticated = 'Not authenticated';
export const Semicolon = ';';
export const Equals = '=';
export const ErrorInvalidSession = 'Invalid session';
export const ApiUserPath = '/api/user';
export const ErrorPopupBlocked = 'Failed to open login popup. Please disable any popup blockers and try again.';
export const ErrorAuthPopupFailed = 'Authentication failed in popup.';
export const ErrorLoginCancelled = 'Login cancelled.';
export const ErrorUseAuthOutsideProvider = 'useAuth must be used within an AuthProvider';
export const GitHubLoginPopupFeaturesTemplate = 'width={0},height={1},top={2},left={3}';
export const ApiAuthGithubPath = '/api/auth/github';
export const ErrorFailedToAuthenticate = 'Failed to authenticate.';
export const ErrorNoCodeFromGitHub = 'Authentication failed: No code received from GitHub.';
export const TitleClickToLogout = 'Click to Logout';
export const LabelLoggingIn = 'Logging in...';
export const LabelLoginWithGitHub = 'Login with GitHub';
export const AllowedExtensions = new Set(['js', 'ts', 'py', 'go', 'java', 'html', 'css', 'md', 'json', 'jsx', 'tsx', 'sh', 'yml', 'yaml', 'rb', 'php', 'c', 'cpp', 'cs', 'rs']);
export const SpecificFilenames = new Set(['dockerfile']);
export const IgnoredPatterns = [/\.min\.js$/i, /\.lock$/i];
export const ImageFileRegex = /\.(png|jpe?g|gif|webp|svg|ico)$/i;
export const LabelLoading = 'Loading...';
export const LabelPreparingAnalysis = 'Preparing for analysis...';
export const LabelPreparingDocumentation = 'Preparing to generate documentation...';
export const ImageFileLabelTemplate = 'Image file: {0}';
export const ErrorFetchFailedTemplate = 'Failed to fetch file: {0}';
export const ErrorCouldNotLoadFileContentTemplate = 'Could not load file content: {0}';
export const ErrorCouldNotLoadFileContent = 'Could not load file content.';
export const ErrorFileNotFoundTemplate = "Could not find file '{0}' in the current repository tree.";
export const ErrorUseRepositoryOutsideProvider = 'useRepository must be used within a RepositoryProvider';
export const LabelInitializingDocEngine = 'Initializing documentation engine...';
export const ErrorNoFilesForDocGen = 'No valid files found for documentation generation based on the current scope.';
export const LabelFetchingDocContents = 'Fetching file contents for documentation...';
export const LabelGeneratingDocumentation = 'Generating documentation...';
export const LabelReceivingDocumentationTemplate = 'Receiving documentation... ({0} KB)';
export const LabelFinalizingDocumentation = 'Finalizing documentation...';
export const LabelInitializingAnalysisEngine = 'Initializing analysis engine...';
export const ErrorNoFilesForAnalysis = 'No valid files found for analysis based on the current scope.';
export const LabelFetchingAnalysisContents = 'Fetching file contents for analysis...';
export const LabelProcessing = 'Processing...';
export const BoldedStatementRegex = /\*\*([^*]+)\*\*/g;
export const LastListItemRegex = /^[-*\d+\.]\s*(.*)\n/gm;
export const ListItemPrefixRegex = /^[-*\d+\.]\s*/;
export const SentenceEndRegex = /[.!?]$/;
export const SentenceSplitRegex = /(?<=[.!?])\s+/;
export const ReportHeaderTemplate = '# Sxentrie Analysis Report for {0}\n\n';
export const ReportRepoUrlTemplate = '**Repository:** https://github.com/{0}/{1}\n\n';
export const ReportDateTemplate = '**Report Generated:** {0}\n\n';
export const ReportHorizontalRule = '---\n';
export const ReportConfigHeader = '## Analysis Configuration\n\n';
export const ReportScopeFileTemplate = '*   **Scope:** Selected File (`{0}`)\n';
export const ReportScopeRepo = '*   **Scope:** Entire Repository\n';
export const ReportModeTemplate = '*   **Mode:** {0} Scan\n';
export const ReportCustomDirectivesTemplate = '*   **Custom Directives:** \n\t```\n\t{0}\n\t```\n';
export const ReportNoCustomDirectives = '*   **Custom Directives:** None\n';
export const ReportOverviewHeader = '## Project Overview\n\n';
export const ReportReviewHeader = '## Technical Review\n\n';
export const ReportNoIssuesFound = '> No specific technical issues were found based on the provided criteria.\n';
export const ReportSummaryTableHeader = '| Severity | Finding | File |\n|:---|:---|:---|';
export const ReportSummaryTableRowTemplate = '| {0} | {1} | `{2}` |';
export const ReportDetailsHeader = '## Findings in Detail\n\n';
export const ReportFindingHeaderTemplate = '### {0}. {1}\n\n';
export const ReportDetailsTableHeader = '| Severity | File | Line(s) |\n|:---|:---|:---|';
export const ReportDetailsTableRowTemplate = '| {0} | `{1}` | {2} |';
export const ReportLineRangeTemplate = '{0}-{1}';
export const ReportNotApplicable = 'N/A';
export const LabelGenerateDocs = 'Generate Docs';
export const LabelAnalyzing = 'Analyzing...';
export const LabelRunAnalysis = 'Run Analysis';
export const LabelGeneratedDocumentation = 'Generated Documentation';
export const TitleClearDocumentation = 'Clear documentation';
export const LabelClear = 'Clear';
export const LabelAnalysisResultsPlaceholder = 'Your analysis results will appear here.';
export const LabelAnalysisHelpText = 'Configure your analysis scope, add custom directives if you like, and click "Run Analysis" or "Generate Docs" to begin.';
export const LabelLoadRepoToEnable = 'Load a repository to enable the Analysis Engine.';
export const TitleShowDismissedFindingsTemplate = 'Show all {0} dismissed findings';
export const AriaLabelRestoreDismissed = 'Restore dismissed findings';
export const TitleDownloadReport = 'Download analysis as Markdown file';
export const AriaLabelDownloadReport = 'Download analysis report';
export const TitleShowConfig = 'Show configuration';
export const TitleHideConfig = 'Hide configuration';
export const CssFontFamilyMono = 'var(--font-family-mono)';
export const CssTransparent = 'transparent';
export const TitleDismissFinding = 'Dismiss this finding';
export const LabelProjectOverview = 'Project Overview';
export const LabelTechnicalReview = 'Technical Review';
export const LabelHiddenFindingsTemplate = '({0} hidden)';
export const LabelNoIssuesFound = 'No specific technical issues found based on the criteria.';
export const LabelHiddenFindingsCountTemplate = '({0} findings are hidden.)';
export const Gitignore = '.gitignore';
export const Lockfile = '.lock';
export const DockerCompose = 'docker-compose';
export const AriaLabelSelectDirectoryTemplate = 'Select directory {0}';
export const AriaLabelSelectFileTemplate = 'Select file {0}';
export const PlaceholderSearchFiles = 'Search files and folders...';
export const AriaLabelSearchFiles = 'Search files in repository';
export const AriaLabelClearSearch = 'Clear search term';
export const ErrorBoundaryFileTreeName = 'File Tree';
export const NoFilesFoundTemplate = 'No files found matching "{0}".';
export const SaveStatusIdle = 'idle';
export const SaveStatusSaved = 'saved';
export const LabelSettings = 'Settings';
export const TitleCloseSettings = 'Close Settings';
export const AriaLabelCloseSettings = 'Close settings panel';
export const LabelApiCredentials = 'API Credentials';
export const TextApiKeyDescription = "Optionally provide your own Google Gemini API key. Your key is stored in your browser's local storage and sent securely to our serverless functions to process your requests. If left blank, the application will use a platform-provided key.";
export const PlaceholderGeminiApiKey = 'Enter your Gemini API Key...';
export const LabelSaved = 'Saved!';
export const LabelSave = 'Save';
export const LogUncaughtErrorTemplate = 'Uncaught error in {0}:';
export const TitleErrorTemplate = 'Error in {0}';
export const TextSomethingWentWrong = 'Something went wrong while rendering this section.';
export const LabelTryAgain = 'Try Again';
export const TextCopyrightTemplate = 'Â© {0} Sxentrie. All Rights Reserved. | Built with React, Typescript, API\'s & lots of coffee.';
export const TitleClearError = 'Clear error message';
export const AppTitle = 'Sxentrie:';
export const AppTagline = ' Instant <code>Code</code> Comprehension.';
export const TitleOpenSettings = 'Open Settings';
export const AriaLabelOpenSettings = 'Open settings panel';
export const TitleExpandPanel = 'Expand Panel';
export const TitleCollapsePanel = 'Collapse Panel';
export const TitleToggleDrawer = 'Toggle file explorer';
export const AriaLabelToggleDrawer = 'Toggle file explorer panel';

// Gemini Service Constants
export const ApiKeyStorageKey = SETTINGS_STORAGE_KEY;
export const ErrorGeminiUnknown = 'An unknown error occurred with the Gemini API.';
export const JsonRegex = /```json\n([\s\S]*?)\n```/;
export const NewlineRegex = /\r?\n/g;
export const ApiKeyInvalid = 'api key not valid';
export const ErrorApiKeyInvalid = 'The provided Gemini API key is invalid or has expired. Please check your settings.';
export const ErrorUnexpected = 'An unexpected error format was received from the API.';
export const ErrorApiKeyNotFound = 'Gemini API key not found. Please add your key in the Settings panel.';
export const SourceCodeTemplate = '--- FILE: {0} ---\n\n{1}';

// Missing constants restored
export const ErrorUnknownDocGen = 'An unknown error occurred during documentation generation.';
export const PlaceholderCustomInstructions = 'Enter custom instructions (e.g., "Focus on security vulnerabilities")...';
export const TitleEnableOnFileSelection = 'Select a file in the file tree to enable this option.';
export const LabelEntireRepo = 'Entire Repository';
export const LabelSelectedFile = 'Selected File';
export const LabelFastScan = 'Fast Scan';
export const LabelDeepScan = 'Deep Scan';
export const TitleGenerateDocs = 'Generate Documentation';
export const LabelGenerating = 'Generating...';
export const ErrorRateLimitExceeded = 'Gemini API rate limit exceeded. Please try again later or switch to "Fast Scan" (Gemini 2.5 Flash).';
export const ReportCodeBlockTemplate = '```{0}\n{1}\n```';
export const ReportFileNameTemplate = '{0}-analysis{1}';